import {setConfig,patch,html,createElement,createDOMElement}from'@je-es/vdom';export{createDOMElement,createElement,html,patch}from'@je-es/vdom';import {configureApi,api}from'@je-es/capi';export{api,configureApi,getApiConfig,http,resetApiConfig}from'@je-es/capi';var Te=Object.defineProperty;var p=(o,t,e,n)=>{for(var r=void 0,s=o.length-1,i;s>=0;s--)(i=o[s])&&(r=(i(t,e,r))||r);return r&&Te(t,e,r),r};var H=class{static{this.styles=new Map;}static{this.scopeCounter=0;}static inject(t,e){let n=e||`style-${this.scopeCounter++}`;if(this.styles.has(n))return n;let r=document.createElement("style");r.setAttribute("data-component",n);let s=this.scopeStyles(t,n);return r.textContent=s,document.head.appendChild(r),this.styles.set(n,r),n}static remove(t){let e=this.styles.get(t);e&&e.parentElement&&(e.parentElement.removeChild(e),this.styles.delete(t));}static scopeStyles(t,e){let n=t.split(`
`),r=[],i=0;for(let a of n){if(a=a.trim(),a.startsWith("@media")){r.push(a);continue}if(i+=(a.match(/{/g)||[]).length,i-=(a.match(/}/g)||[]).length,a.includes("{")&&!a.startsWith("@")&&!a.startsWith("}")){let l=a.substring(0,a.indexOf("{")).trim(),c=a.substring(a.indexOf("{"));if(l===":root"||l==="*"||a.startsWith("@"))r.push(a);else {let d=`[data-scope="${e}"] ${l}`;r.push(`${d} ${c}`);}}else r.push(a);}return r.join(`
`)}static clear(){for(let[,t]of this.styles)t.parentElement&&t.parentElement.removeChild(t);this.styles.clear();}};function pe(o,...t){let e="";for(let n=0;n<o.length;n++)e+=o[n],n<t.length&&(e+=t[n]);return e}var X=class{constructor(){this.queue=new Set;this.isFlushScheduled=false;this.isFlushing=false;}schedule(t){if(this.isFlushing){requestAnimationFrame(()=>this.schedule(t));return}this.queue.add(t),this.isFlushScheduled||(this.isFlushScheduled=true,Promise.resolve().then(()=>{requestAnimationFrame(()=>this.flush());}));}flushSync(t){t();}flush(){if(this.queue.size===0){this.isFlushScheduled=false;return}this.isFlushing=true,this.isFlushScheduled=false;let t=Array.from(this.queue);this.queue.clear();for(let e of t)try{e();}catch(n){console.error("Error during update:",n);}this.isFlushing=false,this.queue.size>0&&this.schedule(()=>{});}clear(){this.queue.clear(),this.isFlushScheduled=false;}get size(){return this.queue.size}},z=new X;var v=class{constructor(t,e){this._isMounted=false;this._isUnmounting=false;this._element=null;this._vnode=null;this._styleId=null;this._isScheduledForUpdate=false;this._updateBatch=new Set;this._refs=new Map;this._subscriptions=[];this._memoCache=new Map;this.props=t||{},this.state=e||{};}setState(t,e){let n={...this.state},r=typeof t=="function"?t(this.state):t;this.state={...this.state,...r},this.onStateChange?.(n,this.state),this.update(),e&&z.schedule(e);}setProps(t){let e={...this.props};this.props={...this.props,...t},this.onPropsChange?.(e,this.props),this.update();}batchUpdate(t){let e=this._isScheduledForUpdate;this._isScheduledForUpdate=true;try{t();}finally{e||(this._isScheduledForUpdate=false,this.update());}}update(t){!this._isMounted||this._isUnmounting||(t&&this._updateBatch.add(t),!this._isScheduledForUpdate&&(this._isScheduledForUpdate=true,z.schedule(()=>{this._isScheduledForUpdate=false,this._updateBatch.clear(),this._performUpdate();})));}forceUpdate(){!this._isMounted||this._isUnmounting||z.flushSync(()=>{this._performUpdate();});}async mount(t){if(this._isMounted){console.warn("Component is already mounted");return}try{await this.onBeforeMount?.(),this._vnode=this.render(),this._element=this._createElementFromVNode(this._vnode),this.styles&&(this._styleId=H.inject(this.styles(),this.constructor.name),this._element?.setAttribute("data-scope",this.constructor.name)),t.appendChild(this._element),this._isMounted=!0,await this.onMount?.();}catch(e){this._handleError(e,{componentStack:this.constructor.name});}}unmount(){if(!(!this._isMounted||this._isUnmounting)){this._isUnmounting=true;try{this.onBeforeUnmount?.(),this._isScheduledForUpdate=!1,this._updateBatch.clear(),this._styleId&&H.remove(this._styleId),this._subscriptions.forEach(t=>t()),this._subscriptions=[],this._element?.parentElement&&this._element.parentElement.removeChild(this._element),this._isMounted=!1,this._element=null,this._vnode=null,this.onUnmount?.(),this._refs.clear(),this._memoCache.clear();}catch(t){this._handleError(t,{componentStack:this.constructor.name});}finally{this._isUnmounting=false;}}}getRef(t){return this._refs.get(t)}createRef(t){return e=>{e?this._refs.set(t,e):this._refs.delete(t);}}memo(t,e,n){let r=this._memoCache.get(t);if(r&&this._areDepsEqual(r.args,n))return r.result;let s=e();return this._memoCache.set(t,{args:n,result:s}),s}subscribe(t){this._subscriptions.push(t);}debounce(t,e){let n=null;return (...r)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{n=null,t.apply(this,r);},e);}}throttle(t,e){let n=0,r=null;return (...s)=>{let i=Date.now(),a=i-n;a>=e?(n=i,t.apply(this,s)):r||(r=setTimeout(()=>{n=Date.now(),r=null,t.apply(this,s);},e-a));}}get element(){return this._element}get isMounted(){return this._isMounted}get isUnmounting(){return this._isUnmounting}async _performUpdate(){if(!this._isMounted||!this._element||this._isUnmounting)return;let t={...this.props},e={...this.state};try{if(this.shouldUpdate&&!this.shouldUpdate(t,e))return;await this.onBeforeUpdate?.(t,e);let n=this.render(),r=this._element.parentElement;if(this._vnode&&r){let s=Array.from(r.childNodes).indexOf(this._element),i=this._convertToVDomNode(this._vnode),a=this._convertToVDomNode(n);patch(r,i,a,s),this._element=r.childNodes[s];}this._vnode=n,this.onUpdate?.(t,e);}catch(n){this._handleError(n,{componentStack:this.constructor.name});}}_convertToVDomNode(t){if(typeof t.type!="string")throw new Error("Component VNodes cannot be converted to VDom nodes");let e={};for(let[r,s]of Object.entries(t.props))r!=="children"&&(e[r]=s);let n=t.children.map(r=>r==null||typeof r=="boolean"?null:typeof r=="string"||typeof r=="number"?r:this._convertToVDomNode(r)).filter(r=>r!==null);return {type:t.type,props:e,children:n}}_createElementFromVNode(t){if(typeof t.type!="string")throw new Error("Component VNodes not supported in _createElementFromVNode");let e=document.createElement(t.type);for(let[n,r]of Object.entries(t.props))n!=="children"&&this._setElementProperty(e,n,r);for(let n of t.children)n==null||n===false||(typeof n=="string"||typeof n=="number"?e.appendChild(document.createTextNode(String(n))):typeof n=="object"&&"type"in n&&e.appendChild(this._createElementFromVNode(n)));return e}_setElementProperty(t,e,n){if(e.startsWith("on")&&typeof n=="function"){let r=e.substring(2).toLowerCase();t.addEventListener(r,n);return}if(e==="className"&&typeof n=="string"){t.className=n;return}if(e==="style"){typeof n=="string"?t.setAttribute("style",n):typeof n=="object"&&n!==null&&Object.assign(t.style,n);return}if(e==="ref"&&typeof n=="function"){n(t);return}if(e==="checked"||e==="disabled"||e==="selected"){(n==="true"||n===true||n==="")&&t.setAttribute(e,"");return}n!=null&&n!==false&&t.setAttribute(e,String(n));}_handleError(t,e){if(console.error(`Error in component ${this.constructor.name}:`,t),this.onError)this.onError(t,e);else throw t}_areDepsEqual(t,e){return t.length!==e.length?false:t.every((n,r)=>n===e[r])}_invalidateAllComputed(){for(let t in this)t.startsWith("_computed_dirty_")&&(this[t]=true);}_triggerWatchers(t,e,n){let r=this.constructor.__watchers__;if(r?.[t]){for(let s of r[t])if(typeof this[s]=="function")try{this[s].call(this,e,n);}catch(i){console.error(`Watcher error in ${s}:`,i);}}}};function f(o,t){if(t&&typeof t=="object"&&"kind"in t){let i=t.name;return t.addInitializer(function(){let a=this;a.constructor.__reactiveProps__||(a.constructor.__reactiveProps__=[]),a.constructor.__reactiveProps__.includes(i)||a.constructor.__reactiveProps__.push(i);}),function(a){let l=this,c=`_state_${i}`;return l[c]=a,Object.defineProperty(this,i,{get(){return this[c]},set(d){let u=this,C=u[c];C!==d&&(u[c]=d,typeof u._invalidateAllComputed=="function"&&u._invalidateAllComputed(),typeof u._triggerWatchers=="function"&&u._triggerWatchers(i,d,C),u._isMounted&&typeof u.update=="function"&&u.update());},enumerable:true,configurable:true}),a}}let e=t,n=o.constructor;n.__reactiveProps__||(n.__reactiveProps__=[]),n.__reactiveProps__.includes(e)||n.__reactiveProps__.push(e);let r=`_state_${e}`,s=`_state_init_${e}`;Object.defineProperty(o,e,{get(){let i=this;if(i[s])return i[r]},set(i){let a=this;if(!a[s]){a[r]=i,a[s]=true;return}let l=a[r];l!==i&&(a[r]=i,typeof a._invalidateAllComputed=="function"&&a._invalidateAllComputed(),typeof a._triggerWatchers=="function"&&a._triggerWatchers(e,i,l),a._isMounted&&typeof a.update=="function"&&a.update());},enumerable:true,configurable:true});}function ct(o,t,e){if(t&&typeof t=="object"&&"kind"in t){let a=t;if(a.kind!=="getter")throw new Error("@computed can only be used on getters");let l=o,c=a.name,d=`_computed_cache_${c}`,u=`_computed_dirty_${c}`;return function(){let C=this;return C[u]===void 0&&(C[u]=true),C[u]===true&&(C[d]=l.call(this),C[u]=false),C[d]}}let n=t;if(!e)throw new Error("@computed requires a property descriptor");let r=e.get;if(!r)throw new Error("@computed can only be used on getters");let s=`_computed_cache_${n}`,i=`_computed_dirty_${n}`;return {get(){let a=this;return a[i]===void 0&&(a[i]=true),a[i]===true&&(a[s]=r.call(this),a[i]=false),a[s]},enumerable:e.enumerable,configurable:e.configurable}}function ut(o){function t(e,n,r){if(n&&typeof n=="object"&&"kind"in n){if(n.kind!=="method")throw new Error("@watch can only be used on methods");let l=n.name;n.addInitializer(function(){let c=this;c.constructor.__watchers__||(c.constructor.__watchers__={}),c.constructor.__watchers__[o]||(c.constructor.__watchers__[o]=[]),c.constructor.__watchers__[o].includes(l)||c.constructor.__watchers__[o].push(l);});return}let s=n;if(!r)throw new Error("@watch requires a property descriptor");let a=e.constructor;return a.__watchers__||(a.__watchers__={}),a.__watchers__[o]||(a.__watchers__[o]=[]),a.__watchers__[o].includes(s)||a.__watchers__[o].push(s),r}return t}var j=class{constructor(t){this._subscribers=new Set;this._value=t,this._defaultValue=t;}get value(){return this._value}set value(t){this._value!==t&&(this._value=t,this._notify());}subscribe(t){this._subscribers.add(t);try{t(this._value);}catch(e){console.error("Context subscriber error:",e);}return ()=>{this._subscribers.delete(t);}}reset(){this.value=this._defaultValue;}update(t){this.value=t(this._value);}_notify(){for(let t of this._subscribers)try{t(this._value);}catch(e){console.error("Context subscriber error:",e);}}get subscriberCount(){return this._subscribers.size}};function ft(o){return new j(o)}var fe=class extends v{onMount(){this.props.context.value=this.props.value;}onUpdate(){this.props.context.value=this.props.value;}onUnmount(){}render(){let t=Array.isArray(this.props.children)?this.props.children:[this.props.children];return html`
                <div class="context-provider" style="display: contents;">
                    ${t}
                </div>
            `}};function gt(o,t){let e=o.subscribe(()=>{t.isMounted&&t.update();});return t.subscribe(()=>e),o.value}var ee=class{constructor(t){this.contexts=new Map;for(let[e,n]of Object.entries(t))this.contexts.set(e,new j(n));}get(t){let e=this.contexts.get(t);if(!e)throw new Error(`Context key "${String(t)}" not found`);return e}set(t,e){let n=this.contexts.get(t);n&&(n.value=e);}subscribe(t,e){let n=this.contexts.get(t);if(!n)throw new Error(`Context key "${String(t)}" not found`);return n.subscribe(e)}reset(){for(let t of this.contexts.values())t.reset();}};function mt(o){return new ee(o)}var L=null,D=0,te=new WeakMap;function xe(o){L=o,D=0;}function Ee(){L=null,D=0;}function q(o){return te.has(o)||te.set(o,[]),te.get(o)}function N(o){if(!L)throw new Error("useState must be called inside a component");let t=L,e=D++,n=q(t);n[e]===void 0&&(n[e]={value:typeof o=="function"?o():o});let r=s=>{let i=n[e],a=typeof s=="function"?s(i.value):s;i.value!==a&&(i.value=a,t.update());};return [n[e].value,r]}function R(o,t){if(!L)throw new Error("useEffect must be called inside a component");let e=L,n=D++,r=q(e),s=r[n];if(!s||!t||!ge(s.deps,t)){if(s?.value&&typeof s.value=="function")try{s.value();}catch(a){console.error("Error in effect cleanup:",a);}Promise.resolve().then(()=>{try{let a=o();r[n]={value:a,deps:t?[...t]:void 0};}catch(a){console.error("Error in effect:",a);}});}}function Le(o,t){if(!L)throw new Error("useMemo must be called inside a component");let e=D++,n=q(L),r=n[e];return (!r||!ge(r.deps,t))&&(n[e]={value:o(),deps:[...t]}),n[e].value}function ne(o,t){return Le(()=>o,t)}function re(o){if(!L)throw new Error("useRef must be called inside a component");let t=D++,e=q(L);return e[t]===void 0&&(e[t]={value:{current:o}}),e[t].value}function yt(o,t){let[e,n]=N(t),r=ne(s=>{n(i=>o(i,s));},[o]);return [e,r]}function wt(o,t){let[e,n]=N(()=>{try{let s=window.localStorage.getItem(o);return s?JSON.parse(s):t}catch(s){return console.error("Error loading from localStorage:",s),t}});return [e,s=>{n(i=>{let a=s instanceof Function?s(i):s;try{window.localStorage.setItem(o,JSON.stringify(a));}catch(l){console.error("Error saving to localStorage:",l);}return a});}]}function Tt(o,t){let[e,n]=N(o);return R(()=>{let r=setTimeout(()=>{n(o);},t);return ()=>{clearTimeout(r);}},[o,t]),e}function Ct(o){let t=re(void 0);return R(()=>{t.current=o;}),t.current}function _t(o=false){let[t,e]=N(o),n=ne(()=>{e(r=>!r);},[]);return [t,n]}function St(o,t){let e=re(o);R(()=>{e.current=o;},[o]),R(()=>{if(t===null)return;let n=setInterval(()=>e.current(),t);return ()=>clearInterval(n)},[t]);}function xt(o,t){let[e,n]=N(null),[r,s]=N(true),[i,a]=N(null),l=ne(async()=>{s(true),a(null);try{let c=await fetch(o,t);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);let d=await c.json();n(d);}catch(c){a(c);}finally{s(false);}},[o]);return R(()=>{l();},[l]),{data:e,loading:r,error:i,refetch:l}}function Et(){let[o,t]=N({width:window.innerWidth,height:window.innerHeight});return R(()=>{let e=()=>{t({width:window.innerWidth,height:window.innerHeight});};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),o}function Lt(o,t,e=window){let n=re(t);R(()=>{n.current=t;},[t]),R(()=>{if(!(e&&"addEventListener"in e))return;let s=i=>{n.current(i);};return e.addEventListener(o,s),()=>{e.removeEventListener(o,s);}},[o,e]);}function kt(o,t){class e extends v{render(){xe(this);try{return o(this.props)}finally{Ee();}}}return t&&Object.defineProperty(e,"name",{value:t}),e}function ge(o,t){if(!o||o.length!==t.length)return  false;for(let e=0;e<o.length;e++)if(o[e]!==t[e])return  false;return  true}var oe=class{constructor(){this.routes=[];this.currentRoute=null;this.mode="history";this.base="/";this.beforeEachHooks=[];this.afterEachHooks=[];this.currentComponent=null;this.routerOutlet=null;this.isNavigating=false;this.scrollBehavior="auto";this.notFoundHandler=null;this._internalPath=null;}init(t,e="history",n="/",r="auto"){this.routes=t,this.mode=e,this.base=n.endsWith("/")?n.slice(0,-1):n,this.scrollBehavior=r,this._initializeRouting(),this._handleRoute();}async push(t,e){this.isNavigating&&(this.isNavigating=false),this._internalPath=t,this.mode==="history"?window.history.pushState(e||{},"",this._buildFullPath(t)):window.location.hash=t,await this._handleRoute();}async replace(t,e){return this._internalPath=t,this.mode==="history"?window.history.replaceState(e||{},"",this._buildFullPath(t)):window.location.hash=t,this._handleRoute()}back(){window.history.back();}forward(){window.history.forward();}go(t){window.history.go(t);}beforeEach(t){this.beforeEachHooks.push(t);}afterEach(t){this.afterEachHooks.push(t);}onNotFound(t){this.notFoundHandler=t;}getCurrentRoute(){return this.currentRoute?{...this.currentRoute}:null}isActive(t,e=false){return this.currentRoute?e?this.currentRoute.path===t:this.currentRoute.path.startsWith(t):false}outlet(){return createElement("div",{"data-router-outlet":"true",style:"display: contents;"})}getRoute(t){return this.routes.find(e=>e.name===t)}async pushNamed(t,e){let n=this.getRoute(t);if(!n){console.error(`Route with name "${t}" not found`);return}let r=n.path;if(e)for(let[s,i]of Object.entries(e))r=r.replace(`:${s}`,i);return this.push(r)}resolve(t){let e=this._matchRoute(t);if(!e)return null;let{route:n,params:r}=e;return {path:t,params:r,query:this._parseQuery(t),meta:n.meta||{},hash:t.includes("#")?t.split("#")[1]:"",name:n.name}}_initializeRouting(){window.addEventListener("popstate",()=>{this._internalPath=null,this._handleRoute();}),this.mode==="hash"&&window.addEventListener("hashchange",()=>{this._internalPath=null,this._handleRoute();}),document.addEventListener("click",t=>{let e=t.target.closest("a[href]");if(e&&this._shouldInterceptLink(e)){t.preventDefault();let n=e.getAttribute("href");if(n){let r=this.mode==="hash"&&n.startsWith("#")?n.substring(1):n.replace(this.base,"");this.push(r);}}});}_shouldInterceptLink(t){return !!(t.getAttribute("href")&&t.hostname===window.location.hostname&&t.target!=="_blank"&&!t.hasAttribute("download")&&t.rel!=="external")}async _handleRoute(){if(!this.isNavigating){this.isNavigating=true;try{let t=this._getCurrentPath(),e=this._matchRoute(t);if(!e){this._handleNotFound(t);return}let{route:n,params:r}=e,s=this._buildRouteObject(t,r,n),i=this.currentRoute||this._buildEmptyRoute();if(!await this._runNavigationGuards(n,s,i))return;this.currentRoute=s,await this._renderComponent(n),this._handleScrollBehavior(s,i),n.meta?.title&&typeof n.meta.title=="string"&&(document.title=n.meta.title),this.afterEachHooks.forEach(l=>l(s,i));}catch(t){console.error("Router error:",t);}finally{this.isNavigating=false;}}}_handleNotFound(t){console.warn(`No route matched for path: ${t}`),this.currentRoute={path:t,params:{},query:this._parseQuery(),meta:{},hash:window.location.hash.substring(1)},this.notFoundHandler&&this.notFoundHandler();}_buildRouteObject(t,e,n){return {path:t,params:e,query:this._parseQuery(),meta:n.meta||{},hash:window.location.hash.substring(1),name:n.name}}_buildEmptyRoute(){return {path:"",params:{},query:{},meta:{},hash:""}}async _runNavigationGuards(t,e,n){if(t.beforeEnter&&!await this._runGuard(t.beforeEnter,e,n))return  false;for(let r of this.beforeEachHooks)if(!await this._runGuard(r,e,n))return  false;return  true}_runGuard(t,e,n){return new Promise(r=>{t(e,n,s=>{s===false?r(false):typeof s=="string"?(this.push(s),r(false)):r(true);});})}async _renderComponent(t){if(!this.routerOutlet&&(this.routerOutlet=document.querySelector('[data-router-outlet="true"]'),!this.routerOutlet)){console.warn("Router outlet not found");return}this.currentComponent&&(this.currentComponent.unmount(),this.currentComponent=null),this.routerOutlet.innerHTML="";try{let e=await this._resolveComponent(t.component);if(!e||typeof e!="function")throw new Error("Component is null or not a constructor");let n=e;this.currentComponent=new n,this.currentComponent&&await this.currentComponent.mount(this.routerOutlet);}catch(e){throw this._renderError(t.path,e),e}}async _resolveComponent(t){if(typeof t=="function"){let n="prototype"in t&&t.prototype?t.prototype:null;if(n&&typeof n=="object"&&"constructor"in n&&n.constructor===t)return t;try{let s=await t();return s.HomePage||s.TodoPage||s.default||Object.values(s).find(a=>{if(typeof a!="function")return !1;let c=a.prototype;return c!==null&&typeof c=="object"&&c!==void 0&&"constructor"in c})||null}catch(s){return console.error("Failed to load lazy component:",s),null}}return null}_renderError(t,e){if(this.routerOutlet){let n=e instanceof Error?e.message:String(e);this.routerOutlet.innerHTML=`
                    <div style="padding: 2rem; background: #fee; border: 2px solid #c00;
                                border-radius: 8px; margin: 2rem;">
                        <h2 style="color: #c00; margin-top: 0;">\u26A0\uFE0F Failed to Load Component</h2>
                        <p><strong>Route:</strong> ${t}</p>
                        <p><strong>Error:</strong> ${n}</p>
                    </div>
                `;}}_handleScrollBehavior(t,e){if(t.hash){let n=document.getElementById(t.hash);if(n){n.scrollIntoView({behavior:this.scrollBehavior});return}}t.path!==e.path&&window.scrollTo({top:0,behavior:this.scrollBehavior});}_getCurrentPath(){if(this._internalPath!==null)return this._internalPath;if(this.mode==="hash")return window.location.hash.substring(1).split("?")[0]||"/";let t=window.location.pathname;return (!t||t==="blank"||t==="about:blank")&&(t="/"),this.base&&t.startsWith(this.base)&&(t=t.substring(this.base.length)),t||"/"}_buildFullPath(t){if(t.startsWith("http"))return t;let e=t.startsWith("/")?t:"/"+t;return this.base+e}_matchRoute(t){let e=t.split("?")[0].split("#")[0];for(let n of this.routes){let r=this._matchPath(n.path,e);if(r!==null)return {route:n,params:r}}return null}_matchPath(t,e){if(t==="*")return {};if(t===e)return {};let n=[],r=t.replace(/\*/g,".*").replace(/:([^/]+)/g,(a,l)=>(n.push(l),"([^/]+)")),s=new RegExp(`^${r}$`),i=e.match(s);return i?n.reduce((a,l,c)=>(a[l]=decodeURIComponent(i[c+1]),a),{}):null}_parseQuery(t){let e=t?t.includes("?")?t.split("?")[1].split("#")[0]:"":window.location.search.substring(1);return e?e.split("&").reduce((n,r)=>{let[s,i]=r.split("=").map(decodeURIComponent);return s&&(n[s]=i||""),n},{}):{}}},I=new oe;function me(o,t=false){console.log(`Navigating to ${o}`),t?I.replace(o):I.push(o),window.dispatchEvent(new CustomEvent("navigation",{detail:{path:o}}));}function Nt(){I.back();}function Rt(){window.history.forward();}function se(){return window.location.pathname}function It(o){return se()===o}function $t(o){return se().startsWith(o)}function Kt(){let o=se();me(o,true);}function Ft(o,t){let e=new URLSearchParams(t).toString();me(`${o}?${e}`);}function Pe(){return new URLSearchParams(window.location.search)}function Ot(o){return Pe().get(o)}var ie=class{constructor(t){this._subscribers=new Set;this._storage=null;this._middleware=[];this._isHydrating=false;if(this._persist=t.persist??false,this._storageKey=t.storageKey||`store_${Date.now()}`,this._persist&&typeof window<"u"&&(this._storage=t.storage==="sessionStorage"?sessionStorage:localStorage),this._persist&&this._storage){let e=this._loadFromStorage();this._state=e!==null?e:t.state;}else this._state=t.state;t.middleware&&(this._middleware=t.middleware);}get state(){return {...this._state}}set state(t){this.setState(t);}setState(t,e){let n={...this._state},r=typeof t=="function"?t(n):t;this._state={...n,...r};for(let s of this._middleware)try{s(this._state,e);}catch(i){console.error("Store middleware error:",i);}this._persist&&!this._isHydrating&&this._saveToStorage(),this._notify();}get(t){return this._state[t]}set(t,e,n){this.setState({[t]:e},n);}subscribe(t){return this._subscribers.add(t),t(this._state),()=>{this._subscribers.delete(t);}}subscribeToKey(t,e){let n=this._state[t],r=s=>{let i=s[t];n!==i&&(n=i,e(i));};return this.subscribe(r)}use(t){this._middleware.push(t);}clear(){if(this._state={},this._persist&&this._storage)try{this._storage.removeItem(this._storageKey);}catch(t){console.error("Failed to clear storage:",t);}this._notify();}reset(t){this._state={...t},this._persist&&this._saveToStorage(),this._notify();}hydrate(){if(!this._persist||!this._storage){console.warn("Cannot hydrate: persistence not enabled");return}this._isHydrating=true;let t=this._loadFromStorage();t!==null&&(this._state=t,this._notify()),this._isHydrating=false;}getSnapshot(){return {state:{...this._state},subscribers:this._subscribers.size,storageKey:this._storageKey}}batch(t){let e=this._notify.bind(this),n=false;this._notify=()=>{n=true;};try{t();}finally{this._notify=e,n&&this._notify();}}_notify(){let t={...this._state};for(let e of this._subscribers)try{e(t);}catch(n){console.error("Store subscriber error:",n);}}_loadFromStorage(){if(!this._storage)return null;try{let t=this._storage.getItem(this._storageKey);return t?JSON.parse(t):null}catch(t){return console.error("Failed to load from storage:",t),null}}_saveToStorage(){if(this._storage)try{this._storage.setItem(this._storageKey,JSON.stringify(this._state));}catch(t){console.error("Failed to save to storage:",t),t instanceof DOMException&&t.name==="QuotaExceededError"&&console.warn("Storage quota exceeded");}}destroy(){this._subscribers.clear(),this._middleware=[],this._state={};}};function Me(o){return new ie(o)}function Vt(o,t){let e=Me({state:{value:t(...o.map(n=>n.state))}});for(let n of o)n.subscribe(()=>{e.setState({value:t(...o.map(r=>r.state))});});return e}function At(o,t,e){return o.subscribe(r=>{let s=e(r);Object.assign(t,s),typeof t.update=="function"&&t.update();})}var W=class{constructor(t){this.translations={};this.currentLanguage="en";this.defaultLanguage="en";this.supportedLanguages=new Set(["en"]);this.cachePath="";t&&(this.defaultLanguage=t.defaultLanguage||"en",this.currentLanguage=this.getStoredLanguage()||t.defaultLanguage||"en",this.cachePath=t.staticPath||"static/i18n",t.supportedLanguages&&(this.supportedLanguages=new Set(t.supportedLanguages)));}loadLanguage(t,e){this.translations[t]||(this.translations[t]={}),this.translations[t]={...this.translations[t],...e},this.supportedLanguages.add(t);}loadTranslations(t){Object.entries(t).forEach(([e,n])=>{this.loadLanguage(e,n);});}setLanguage(t){this.supportedLanguages.has(t)?(this.currentLanguage=t,this.storeLanguage(t),this.dispatchLanguageChangeEvent()):this.supportedLanguages.has(this.defaultLanguage)&&(this.currentLanguage=this.defaultLanguage);}getLanguage(){return this.currentLanguage}getSupportedLanguages(){return Array.from(this.supportedLanguages)}t(t,e){let n=this.currentLanguage,r=this.translations[n]?.[t]||this.translations[this.defaultLanguage]?.[t]||t;return e&&Object.entries(e).forEach(([s,i])=>{let a=this.translations[n]?.[i]||this.translations[this.defaultLanguage]?.[i]||i;r=r.replace(new RegExp(`\\{${s}\\}`,"g"),a);}),r}tLang(t,e,n){let r=this.currentLanguage;this.currentLanguage=e;let s=this.t(t,n);return this.currentLanguage=r,s}getTranslations(){return this.translations[this.currentLanguage]||{}}hasKey(t){return !!(this.translations[this.currentLanguage]?.[t]||this.translations[this.defaultLanguage]?.[t])}createTranslator(t){let e=()=>t();return typeof window<"u"?(window.addEventListener("languagechange",e),()=>window.removeEventListener("languagechange",e)):()=>{}}async loadFromUrl(t){let e=Array.isArray(t)?t:[t],n={};for(let r of e)if(r.includes("*")){let s=r.replace("*.json",""),i=this.supportedLanguages;for(let a of i)try{let l=await fetch(`${s}${a}.json`);if(l.ok){let c=await l.json();n[a]=c;}}catch(l){console.warn(`Failed to load translations from ${s}${a}.json:`,l);}}else try{let s=await fetch(r);if(s.ok){let i=await s.json(),a=r.match(/([a-z]{2,3})\.json$/i),l=a?a[1].toLowerCase():"en";n[l]=i,this.supportedLanguages.add(l);}}catch(s){console.warn(`Failed to load translations from ${r}:`,s);}Object.keys(n).length>0&&this.loadTranslations(n);}getStoredLanguage(){return typeof localStorage<"u"&&localStorage.getItem("app-language")||null}storeLanguage(t){typeof localStorage<"u"&&localStorage.setItem("app-language",t);}dispatchLanguageChangeEvent(){typeof window<"u"&&window.dispatchEvent(new CustomEvent("languagechange",{detail:{language:this.currentLanguage}}));}},V=null;function Ne(o){return V||(V=new W(o)),V}function E(){return V||(V=new W),V}function h(o,t){return E().t(o,t)}function Bt(o,t,e){return E().tLang(o,t,e)}function Ut(o){E().setLanguage(o);}function zt(){return E().getLanguage()}function jt(o,t){E().loadLanguage(o,t);}function qt(o){E().loadTranslations(o);}function Wt(){return E().getSupportedLanguages()}function Gt(o){return E().hasKey(o)}function Jt(){return E().getTranslations()}function Yt(o){return E().createTranslator(o)}async function Qt(o){return E().loadFromUrl(o)}function be(o){return Ne(o)}function nn(o){let t=o;return {async build(){if(!t.build){console.warn("No build configuration provided");return}console.log("\u{1F528} Building @je-es/client application...");try{await this._buildJS(),await this._buildStyles(),console.log("\u2705 Build completed successfully!");}catch(e){throw console.error("\u274C Build error:",e),e}},async _buildJS(){if(!t.build)return;let e=await Bun.build({entrypoints:[t.build.entry],outdir:t.build.output.substring(0,t.build.output.lastIndexOf("/")),target:"browser",minify:t.build.minify??false,sourcemap:t.build.sourcemap?"external":"none",splitting:t.build.optimization?.splitChunks??false,naming:{entry:t.build.output.substring(t.build.output.lastIndexOf("/")+1)},external:["sass","fs","path","url","util","stream","buffer","events","crypto","os","child_process"]});if(!e.success)throw console.error("\u274C JS Build failed:",e.logs),new Error("JS Build failed")},async _buildStyles(){let e=t.build?.styles?.input||"./app/gui/style",n=t.build?.styles?.output||"./static/client.css",r=await import('sass'),{writeFileSync:s,existsSync:i,mkdirSync:a}=await import('fs'),{join:l,dirname:c}=await import('path'),d=c(n),u=n.split("/").pop()||"client.css",C=l(e,"index.scss");if(!i(C)){console.log("\u26A0\uFE0F  No index.scss found, skipping CSS build");return}try{i(d)||a(d,{recursive:!0});let O=r.compile(C,{style:t.build?.minify?"compressed":"expanded",sourceMap:!!t.build?.sourcemap,loadPaths:[e]}),he=l(d,u);s(he,O.css,"utf-8"),t.build?.sourcemap&&O.sourceMap&&s(`${he}.map`,JSON.stringify(O.sourceMap),"utf-8");}catch(O){throw console.error("\u274C CSS Build failed:",O),O}},async _collectScssFiles(e){let{readdirSync:n,statSync:r,existsSync:s}=await import('fs'),{join:i,extname:a}=await import('path'),l=[];if(!s(e))return l;let c=n(e);for(let d of c){let u=i(e,d),C=r(u);C.isDirectory()?l.push(...await this._collectScssFiles(u)):C.isFile()&&a(d)===".scss"&&!d.startsWith("_")&&l.push(u);}return l.sort()},async watch(){console.log("\u{1F440} Watching for changes..."),await this.build();let{watch:e}=await import('fs'),{dirname:n}=await import('path'),{existsSync:r}=await import('fs');if(t.build?.entry){let i=n(t.build.entry);e(i,{recursive:true},async(a,l)=>{if(l&&(l.endsWith(".ts")||l.endsWith(".tsx"))){console.log(`\u{1F504} ${l} changed, rebuilding JS...`);try{await this._buildJS(),console.log("\u2705 JS rebuild complete");}catch(c){console.error("\u274C JS rebuild failed:",c);}}});}let s="./app/style";r(s)&&e(s,{recursive:true},async(i,a)=>{if(a&&a.endsWith(".scss")){console.log(`\u{1F504} ${a} changed, rebuilding CSS...`);try{await this._buildStyles(),console.log("\u2705 CSS rebuild complete");}catch(l){console.error("\u274C CSS rebuild failed:",l);}}});},init(){if(t.i18n&&be({defaultLanguage:t.i18n.defaultLanguage,supportedLanguages:t.i18n.supportedLanguages,staticPath:t.i18n.staticPath}),t.api){let e={baseURL:t.api.baseURL,timeout:t.api.timeout,headers:t.api.headers};t.api.interceptors&&(e.interceptors={request:t.api.interceptors.request||null,response:t.api.interceptors.response||null,error:t.api.interceptors.error||null}),configureApi(e);}t.router&&t.app?.routes&&(I.init(t.app.routes,t.router.mode,t.router.base),t.router.beforeEach&&I.beforeEach(t.router.beforeEach),t.router.afterEach&&I.afterEach(t.router.afterEach)),t.app?.root&&(document.querySelector(t.app.root)||console.error(`\u274C Root element "${t.app.root}" not found`)),t.devTools?.enabled&&this._enableDevTools();},_enableDevTools(){window.__JEES_DEV__={router:I,config:t,version:"0.0.1"};},getConfig(){return t}}}var B={toast:"bb_toast",container:"bb_toastContainer",icon:"bb_toastIcon",msg:"bb_toastMsg"},J=class extends v{constructor(){super(...arguments);this.messages=[];this.nextId=0;}show(e,n="info",r=2e3,s){let i=this.nextId++;this.messages=[...this.messages,{id:i,message:e,type:n,translateKey:s}],setTimeout(()=>{this.messages=this.messages.filter(a=>a.id!==i);},r);}success(e,n,r){this.show(e,"success",n,r);}error(e,n,r){this.show(e,"error",n,r);}info(e,n,r){this.show(e,"info",n,r);}warning(e,n,r){this.show(e,"warning",n,r);}render(){return this.messages.length===0?html``:createElement("div",{className:B.container},...this.messages.map(e=>this.renderToast(e)))}renderToast(e){let n={success:"fas fa-check-circle",error:"fas fa-exclamation-circle",info:"fas fa-info-circle",warning:"fas fa-exclamation-triangle"},r=e.translateKey?h(e.translateKey):e.message;return createElement("div",{key:String(e.id),className:`${B.toast} ${B.toast}--${e.type}`,"data-translate":e.translateKey||void 0},createElement("i",{className:`${n[e.type]} ${B.icon}`}),createElement("span",{className:B.msg},r))}};p([f],J.prototype,"messages");var $=null;function $e(o){if($)return $;let t=o||document.createElement("div");return o||document.body.appendChild(t),$=new J,$.mount(t),$}function U(){return $||($=$e()),$}var cn={show:(o,t="info",e,n)=>{U().show(o,t,e,n);},success:(o,t,e)=>{U().success(o,t,e);},error:(o,t,e)=>{U().error(o,t,e);},info:(o,t,e)=>{U().info(o,t,e);},warning:(o,t,e)=>{U().warning(o,t,e);}};var w={loader:{container:"bb_loaderContainer",containerOverlay:"bb_loaderContainer--overlay",bg:"bb_loaderBg",loader:"bb_loader"},spinner:{container:"bb_loaderSpinnerContainer",icon:"bb_loaderSpinnerIcon",dot:"bb_loaderSpinnerDot",pulse:"bb_loaderSpinnerPulse",text:"bb_loaderSpinnerText"},progress:{container:"bb_loaderProgressContainer",bar:"bb_loaderProgressBar",text:"bb_loaderProgressText"}},M=class extends v{constructor(){super(...arguments);this.visible=false;this.message="";this.variant="spinner";this.size="medium";this.overlay=true;this.progress=0;this.showProgress=false;this.animationFrame=null;this.hideTimeout=null;this.handleKeyPress=e=>{e.key==="Escape"&&this.visible&&!this.overlay&&this.hide();};}async onMount(){this.setupKeyboardListener(),this.initializeAccessibility(),window.addEventListener("languagechange",()=>{this.message||this.update();});}onUnmount(){this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.hideTimeout&&clearTimeout(this.hideTimeout),document.removeEventListener("keydown",this.handleKeyPress);}render(){let e=[w.loader.container,this.overlay?`${w.loader.containerOverlay}`:"",`${w.loader.container}--${this.size}`].filter(Boolean).join(" ");return createElement("div",{className:e,"data-status":this.visible?"visible":"hidden",role:"status","aria-live":"polite","aria-busy":"true"},createElement("div",{className:w.loader.bg}),createElement("div",{className:w.loader.loader},this.renderSpinner(),this.renderMessage(),this.showProgress?this.renderProgressBar():null))}renderSpinner(){let e=`${w.spinner.container} ${w.spinner.container}--${this.variant}`;switch(this.variant){case "dots":return createElement("div",{className:e},createElement("div",{className:w.spinner.dot}),createElement("div",{className:w.spinner.dot}),createElement("div",{className:w.spinner.dot}));case "pulse":return createElement("div",{className:e},createElement("div",{className:w.spinner.pulse}));case "spinner":default:return createElement("div",{className:e},createElement("div",{className:w.spinner.icon}))}}renderMessage(){let e=this.message||h("global.loading");return createElement("div",{className:w.spinner.text,"data-translate":this.message?void 0:"global.loading"},e)}renderProgressBar(){return createElement("div",{className:w.progress.container},createElement("div",{className:w.progress.bar,style:`width: ${this.progress}%`,"aria-valuenow":this.progress.toString(),"aria-valuemin":"0","aria-valuemax":"100"}),createElement("div",{className:w.progress.text},`${Math.round(this.progress)}%`))}show(e){typeof e=="string"?this.message=e:e&&(this.message=e.message||"",this.variant=e.variant||"spinner",this.size=e.size||"medium",this.overlay=e.overlay!==void 0?e.overlay:true),this.visible=true,this.progress=0,this.showProgress=false,this.applyBodyLock(),this.update();}hide(e=0){this.hideTimeout&&clearTimeout(this.hideTimeout),e>0?this.hideTimeout=window.setTimeout(()=>{this.performHide();},e):this.performHide();}setMessage(e){this.message=e,this.update();}setProgress(e){this.showProgress=true,this.progress=Math.max(0,Math.min(100,e)),this.update();}updateProgress(e){this.setProgress(this.progress+e);}performHide(){this.visible=false,this.message="",this.progress=0,this.showProgress=false,this.removeBodyLock(),this.update();}applyBodyLock(){this.overlay&&(document.body.style.overflow="hidden");}removeBodyLock(){document.body.style.overflow="";}setupKeyboardListener(){this.handleKeyPress=this.handleKeyPress.bind(this),document.addEventListener("keydown",this.handleKeyPress);}initializeAccessibility(){let e=this.element?.querySelector(`.${w.spinner.container}`);e&&e.setAttribute("aria-label",h("loading"));}isVisible(){return this.visible}getStatus(){return {visible:this.visible,message:this.message,progress:this.progress}}};p([f],M.prototype,"visible"),p([f],M.prototype,"message"),p([f],M.prototype,"variant"),p([f],M.prototype,"size"),p([f],M.prototype,"overlay"),p([f],M.prototype,"progress"),p([f],M.prototype,"showProgress");var K=class extends v{constructor(e){super(e);this.fields=[];this.formData={};this.isSubmitting=false;this.submitError="";this.submitSuccess=false;this.fields=this.props.fields.map(n=>({...n,error:void 0,touched:false}));for(let n of this.fields)this.formData[n.name]=n.value||"";}onMount(){}handleChange(e,n){this.formData[e]=n;let r=this.fields.find(s=>s.name===e);r&&this.props.autoValidate&&(r.error=this.validateField(r,n),r.touched=true),this.update();}handleBlur(e){let n=this.fields.find(r=>r.name===e);n&&(n.touched=true,n.error=this.validateField(n,this.formData[e]),this.update());}validateField(e,n){let r=e.validation;if(!r)return;if(r.required&&!n)return r.message||`${e.label||e.name} is required`;if(!n)return;let s=String(n);if(r.minLength&&s.length<r.minLength)return r.message||`Minimum ${r.minLength} characters required`;if(r.maxLength&&s.length>r.maxLength)return r.message||`Maximum ${r.maxLength} characters allowed`;if(r.min!==void 0&&Number(n)<r.min)return r.message||`Minimum value is ${r.min}`;if(r.max!==void 0&&Number(n)>r.max)return r.message||`Maximum value is ${r.max}`;if(r.pattern&&!r.pattern.test(s))return r.message||"Invalid format";if(r.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s))return r.message||"Invalid email address";if(r.url&&!/^https?:\/\/.+/.test(s))return r.message||"Invalid URL";if(r.custom){let i=r.custom(n);if(i!==true)return typeof i=="string"?i:"Validation failed"}}validateForm(){let e=true,n={};for(let r of this.fields){let s=this.validateField(r,this.formData[r.name]);r.error=s,r.touched=true,s&&(e=false,n[r.name]=s);}return this.update(),!e&&this.props.onValidationError&&this.props.onValidationError(n),e}async handleSubmit(e){if(e.preventDefault(),!this.validateForm()){let n=this.fields.find(r=>r.error);n&&document.querySelector(`[name="${n.name}"]`)?.focus();return}this.isSubmitting=true,this.submitError="",this.submitSuccess=false,this.update();try{if(this.props.onSubmit)await this.props.onSubmit(this.formData,e);else if(this.props.endpoint){let n=await api({method:this.props.method||"POST",url:this.props.endpoint,data:this.formData});this.submitSuccess=!0,this.props.onSuccess&&this.props.onSuccess(n.data);}}catch(n){let r=n instanceof Error?n.message:"Submission failed";this.submitError=r,this.props.onError&&this.props.onError(n);}finally{this.isSubmitting=false,this.update();}}renderLabel(e){return !e.label&&!e.icon?"":e.icon?html`
                    <label for=${e.name}>
                        <i class="fa ${e.icon}"></i>
                        ${e.label?html`<span>${e.label}</span>`:""}
                    </label>
                `:html`<label for=${e.name}>${e.label}</label>`}renderField(e){let n=this.formData[e.name]||"",r=this.renderLabel(e);switch(e.type){case "textarea":return html`
                        <div class="form-field ${e.className||""}">
                            ${r}
                            <textarea
                                id=${e.name}
                                name=${e.name}
                                placeholder=${e.placeholder||""}
                                value=${String(n)}
                                disabled=${String(e.disabled||this.isSubmitting)}
                                oninput=${s=>{let i=s.target;this.handleChange(e.name,i.value);}}
                                onblur=${()=>this.handleBlur(e.name)}
                            ></textarea>
                            ${e.error&&e.touched?html`
                                <span class="field-error">${e.error}</span>
                            `:""}
                        </div>
                    `;case "select":{let i=(e.options||[]).map(a=>html`
                        <option value=${String(a.value)}>${a.label}</option>
                    `);return html`
                        <div class="form-field ${e.className||""}">
                            ${r}
                            <select
                                id=${e.name}
                                name=${e.name}
                                value=${String(n)}
                                disabled=${String(e.disabled||this.isSubmitting)}
                                onchange=${a=>{let l=a.target;this.handleChange(e.name,l.value);}}
                                onblur=${()=>this.handleBlur(e.name)}
                            >
                                <option value="">Select...</option>
                                ${i}
                            </select>
                            ${e.error&&e.touched?html`
                                <span class="field-error">${e.error}</span>
                            `:""}
                        </div>
                    `}case "checkbox":return html`
                        <div class="form-field form-field-checkbox ${e.className||""}">
                            <label>
                                <input
                                    type="checkbox"
                                    id=${e.name}
                                    name=${e.name}
                                    checked=${String(n)}
                                    disabled=${String(e.disabled||this.isSubmitting)}
                                    onchange=${s=>{let i=s.target;this.handleChange(e.name,i.checked);}}
                                />
                                ${e.icon?html`<i class="fa ${e.icon}"></i>`:""}
                                ${e.label||""}
                            </label>
                            ${e.error&&e.touched?html`
                                <span class="field-error">${e.error}</span>
                            `:""}
                        </div>
                    `;default:return html`
                        <div class="form-field ${e.className||""}">
                            ${r}
                            <input
                                type="${e.type||"text"}"
                                id="${e.name}"
                                name="${e.name}"
                                placeholder="${e.placeholder||""}"
                                value="${String(n)}"
                                disabled="${e.disabled||this.isSubmitting}"
                                oninput=${s=>{let i=s.target;this.handleChange(e.name,i.value);}}
                                onblur=${()=>this.handleBlur(e.name)}
                            />
                            ${e.error&&e.touched?html`
                                <span class="field-error">${e.error}</span>
                            `:""}
                        </div>
                    `}}render(){let e=this.props.submitButton||{},n=this.fields.map(r=>this.renderField(r));return html`
                <form
                    class="smart_form ${this.props.className||""}"
                    onsubmit=${r=>this.handleSubmit(r)}
                >
                    ${this.submitError?html`
                        <div class="alert alert-error">${this.submitError}</div>
                    `:""}

                    ${this.submitSuccess?html`
                        <div class="alert alert-success">Submitted successfully!</div>
                    `:""}

                    ${n}

                    <button
                        type="submit"
                        class="submit-button ${e.className||""}"
                        disabled=${String(this.isSubmitting)}
                    >
                        ${this.isSubmitting?e.loadingLabel||"Submitting...":e.label||"Submit"}
                    </button>
                </form>
            `}styles(){return pe`
                .smart_form {
                    max-width: 100%;
                }
                .form-field {
                    margin-bottom: 1rem;
                }
                .form-field label {
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                    margin-bottom: 0.5rem;
                    font-weight: 500;
                }
                .form-field label i {
                    color: #6b7280;
                }
                .form-field input,
                .form-field textarea,
                .form-field select {
                    width: 100%;
                    padding: 0.5rem;
                    border: 1px solid #d1d5db;
                    border-radius: 0.375rem;
                    font-size: 1rem;
                }
                .form-field input:focus,
                .form-field textarea:focus,
                .form-field select:focus {
                    outline: none;
                    border-color: #3b82f6;
                    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
                }
                .form-field-checkbox label {
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                }
                .form-field-checkbox input[type="checkbox"] {
                    width: auto;
                }
                .field-error {
                    display: block;
                    color: #dc2626;
                    font-size: 0.875rem;
                    margin-top: 0.25rem;
                }
                .submit-button {
                    width: 100%;
                    padding: 0.75rem 1rem;
                    background: #3b82f6;
                    color: white;
                    border: none;
                    border-radius: 0.375rem;
                    font-size: 1rem;
                    font-weight: 500;
                    cursor: pointer;
                    transition: background 0.2s;
                }
                .submit-button:hover:not(:disabled) {
                    background: #2563eb;
                }
                .submit-button:disabled {
                    opacity: 0.6;
                    cursor: not-allowed;
                }
                .alert {
                    padding: 0.75rem;
                    border-radius: 0.375rem;
                    margin-bottom: 1rem;
                }
                .alert-error {
                    background: #fee2e2;
                    color: #dc2626;
                }
                .alert-success {
                    background: #d1fae5;
                    color: #065f46;
                }
            `}};p([f],K.prototype,"fields"),p([f],K.prototype,"formData"),p([f],K.prototype,"isSubmitting"),p([f],K.prototype,"submitError"),p([f],K.prototype,"submitSuccess");function ve(o){return new K(o).render()}var y={container:"bb_popupContainer",overlay:"bb_popupOverlay",popup:{base:"bb_popup",close:"bb_popupClose"},header:{container:"bb_popupHeader",icon:"bb_popupHeaderIcon",content:"bb_popupHeaderContent",title:"bb_popupHeaderContentTitle",description:"bb_popupHeaderContentDesc"},body:{container:"bb_popupBody",message:"bb_popupBodyMsg",input:"bb_popupBodyInput",formContainer:"bb_popupBodyFormContainer"},footer:"bb_popupFooter",button:"bb_btn"},Y=class extends v{constructor(){super(...arguments);this.popups=[];this.nextId=0;}async onMount(){this.setupKeyboardListener(),window.addEventListener("languagechange",()=>{this.update();});}onUnmount(){this.handleEscapeKey&&document.removeEventListener("keydown",this.handleEscapeKey);}render(){return this.popups.length===0?createElement("div",{className:y.container}):createElement("div",{className:y.container},...this.popups.map(e=>this.renderPopup(e)))}renderPopup(e){let n=`bb_popup--${e.size||"medium"}`,r=e.variant?`bb_popup--${e.variant}`:"";return createElement("div",{key:String(e.id),className:y.overlay,"data-popup-id":e.id,onClick:s=>{s.target.classList.contains(y.overlay)&&e.closeOnOverlay!==false&&this.closePopup(e.id,false);}},createElement("div",{className:`${y.popup.base} ${n} ${r}`,role:"dialog","aria-modal":"true","aria-labelledby":`popup-title-${e.id}`},e.showCloseButton!==false?createElement("button",{className:y.popup.close,onClick:()=>this.closePopup(e.id,false),"aria-label":"Close"},createElement("i",{className:"fas fa-times"})):null,createElement("div",{className:y.header.container},e.icon?createElement("div",{className:y.header.icon},createElement("i",{className:e.icon})):null,createElement("div",{className:y.header.content},createElement("h2",{id:`popup-title-${e.id}`,className:y.header.title,"data-translate":e.titleTranslateKey},e.titleTranslateKey?h(e.titleTranslateKey):e.title),e.description?createElement("p",{className:y.header.description,"data-translate":e.descriptionTranslateKey},e.descriptionTranslateKey?h(e.descriptionTranslateKey):e.description):null)),createElement("div",{className:y.body.container},e.message?createElement("p",{className:y.body.message,"data-translate":e.messageTranslateKey},e.messageTranslateKey?h(e.messageTranslateKey):e.message):null,e.type==="prompt"?createElement("input",{type:"text",className:y.body.input,value:e.inputValue||"",placeholder:h("popup.prompt.placeholder"),"data-translate":"popup.prompt.placeholder",onInput:s=>{e.inputValue=s.target.value;}}):null,e.type==="form"&&e.formConfig?createElement("div",{className:y.body.formContainer},ve(e.formConfig)):null,e.customContent||null),e.buttons&&e.buttons.length>0&&e.type!=="form"?createElement("div",{className:y.footer},...e.buttons.map(s=>createElement("button",{className:`${y.button} ${s.variant||"secondary"}`,"data-translate":s.translateKey,disabled:s.loading||e.isSubmitting,onClick:async()=>{s.loading||e.isSubmitting||await s.onClick();}},s.icon?createElement("i",{className:s.icon}):null,s.loading||e.isSubmitting?createElement("i",{className:"fas fa-spinner fa-spin"}):null," ",s.translateKey?h(s.translateKey):s.label))):null))}show(e){return new Promise(n=>{let r=this.nextId++,s={...e,id:r,resolve:n,type:e.type||"custom",size:e.size||"medium",closeOnOverlay:e.closeOnOverlay!==false,closeOnEscape:e.closeOnEscape!==false,showCloseButton:e.showCloseButton!==false,isSubmitting:false};this.popups=[...this.popups,s],this.applyBodyLock(),this.update();})}showForm(e){return new Promise((n,r)=>{let s=this.nextId++,i={...e.formConfig,onSubmit:async l=>{let c=this.popups.find(d=>d.id===s);c&&(c.isSubmitting=true,this.update());try{e.formConfig.onSubmit&&await e.formConfig.onSubmit(l,void 0),this.closePopup(s,l),n(l);}catch(d){c&&(c.isSubmitting=false,this.update()),e.formConfig.onError&&e.formConfig.onError(d);}},submitButton:{...e.formConfig.submitButton,className:e.formConfig.submitButton?.className||`${y.button} primary wide`}},a={title:e.title,titleTranslateKey:e.titleTranslateKey,description:e.description,descriptionTranslateKey:e.descriptionTranslateKey,type:"form",variant:e.variant||"default",size:e.size||"medium",icon:e.icon,formConfig:i,closeOnOverlay:e.closeOnOverlay!==false,closeOnEscape:e.closeOnEscape!==false,showCloseButton:e.showCloseButton!==false,id:s,resolve:n,isSubmitting:false};this.popups=[...this.popups,a],this.applyBodyLock(),this.update();})}confirm(e){return new Promise(n=>{let r=this.nextId++,s={id:r,title:e.title,titleTranslateKey:e.titleTranslateKey,message:e.message,messageTranslateKey:e.messageTranslateKey,type:"confirm",variant:e.variant||"default",size:e.size||"small",icon:e.icon,resolve:n,onConfirm:e.onConfirm,onCancel:e.onCancel,buttons:[{label:e.cancelLabel||"Cancel",translateKey:e.cancelTranslateKey||"button.cancel",variant:"secondary",icon:"fas fa-times",onClick:async()=>{e.onCancel&&await e.onCancel(),this.closePopup(r,false);}},{label:e.confirmLabel||"Confirm",translateKey:e.confirmTranslateKey||"button.confirm",variant:e.variant==="danger"?"danger":"primary",icon:"fas fa-check",onClick:async()=>{e.onConfirm&&await e.onConfirm(),this.closePopup(r,true);}}]};this.popups=[...this.popups,s],this.applyBodyLock(),this.update();})}alert(e){return new Promise(n=>{let r=this.nextId++,s={id:r,title:e.title,titleTranslateKey:e.titleTranslateKey,message:e.message,messageTranslateKey:e.messageTranslateKey,type:"alert",variant:e.variant||"info",size:e.size||"small",icon:e.icon,resolve:n,onConfirm:e.onConfirm,buttons:[{label:e.okLabel||"OK",translateKey:e.okTranslateKey||"popup.ok",variant:"primary",icon:"fas fa-check",onClick:async()=>{e.onConfirm&&await e.onConfirm(),this.closePopup(r,true);}}]};this.popups=[...this.popups,s],this.applyBodyLock(),this.update();})}prompt(e){return new Promise(n=>{let r=this.nextId++,s={id:r,title:e.title,titleTranslateKey:e.titleTranslateKey,message:e.message,messageTranslateKey:e.messageTranslateKey,type:"prompt",variant:"default",icon:e.icon,inputValue:e.defaultValue||"",resolve:n,onConfirm:e.onConfirm,onCancel:e.onCancel,buttons:[{label:e.cancelLabel||"Cancel",translateKey:e.cancelTranslateKey||"popup.cancel",variant:"secondary",onClick:async()=>{e.onCancel&&await e.onCancel(),this.closePopup(r,null);}},{label:e.confirmLabel||"OK",translateKey:e.confirmTranslateKey||"popup.ok",variant:"primary",onClick:async()=>{let i=s.inputValue||"";e.onConfirm&&await e.onConfirm(i),this.closePopup(r,i);}}]};this.popups=[...this.popups,s],this.applyBodyLock();})}closePopup(e,n){let r=this.popups.find(s=>s.id===e);r?.resolve&&r.resolve(n),this.popups=this.popups.filter(s=>s.id!==e),this.popups.length===0&&this.removeBodyLock(),this.update();}closeAll(){this.popups.forEach(e=>{e.resolve&&e.resolve(false);}),this.popups=[],this.removeBodyLock(),this.update();}applyBodyLock(){document.body.style.overflow="hidden";}removeBodyLock(){document.body.style.overflow="";}setupKeyboardListener(){this.handleEscapeKey=e=>{if(e.key==="Escape"&&this.popups.length>0){let n=this.popups[this.popups.length-1];n.closeOnEscape!==false&&this.closePopup(n.id,false);}},document.addEventListener("keydown",this.handleEscapeKey);}};p([f],Y.prototype,"popups");var F=null;function Fe(o){if(F)return F;let t=o||document.createElement("div");return o||document.body.appendChild(t),F=new Y,F.mount(t),F}function k(){return F||(F=Fe()),F}var Rn={show:o=>k().show(o),confirm:o=>k().confirm(o),alert:o=>k().alert(o),prompt:o=>k().prompt(o),showForm:o=>k().showForm(o),closePopup:(o,t)=>k().closePopup(o,t),closeLastPopup:()=>k().closePopup(k().popups.length-1,false),closeFirstPopup:()=>k().closePopup(0,false),closeAll:()=>k().closeAll()};var P={container:"bb_tabbedview",header:"bb_tabbedviewHeader",tab:{base:"bb_tabbedviewTab",active:"bb_tabbedviewTab--active",disabled:"bb_tabbedviewTab--disabled",badge:"bb_tabbedviewBadge"},content:{container:"bb_tabbedviewContent",emptyState:"bb_tabbedviewEmptyState",error:"bb_tabbedviewError"}},x=class extends v{constructor(){super(...arguments);this.activeTabId="";this.tabs=[];this.position="top";this.style="default";this.className="";this.headerClassName="";this.contentClassName="";this.showTabCount=false;this.persistState=false;this.storageKey="tabbedview-active";this.currentTabComponent=null;}async onMount(){window.addEventListener("languagechange",()=>{this.update();});}onUnmount(){this.currentTabComponent&&typeof this.currentTabComponent.onUnmount=="function"&&this.currentTabComponent.onUnmount();}init(e){if(this.tabs=e.tabs,this.position=e.position||"top",this.style=e.style||"default",this.className=e.className||"",this.headerClassName=e.headerClassName||"",this.contentClassName=e.contentClassName||"",this.showTabCount=e.showTabCount||false,this.persistState=e.persistState||false,this.storageKey=e.storageKey||"tabbedview-active",this.onChange=e.onChange,this.persistState){let n=localStorage.getItem(this.storageKey);n&&this.tabs.find(r=>r.id===n)&&(this.activeTabId=n);}return this.activeTabId||(this.activeTabId=e.defaultTab||this.tabs[0]?.id||""),this.update(),this}async setActiveTab(e){let n=this.tabs.find(r=>r.id===e);!n||n.disabled||(this.currentTabComponent&&typeof this.currentTabComponent.onUnmount=="function"&&this.currentTabComponent.onUnmount(),this.currentTabComponent=null,this.activeTabId=e,this.persistState&&localStorage.setItem(this.storageKey,e),n.onActivate&&await n.onActivate(),this.onChange&&await this.onChange(e),this.update());}addTab(e){this.tabs=[...this.tabs,e],this.update();}removeTab(e){this.tabs=this.tabs.filter(n=>n.id!==e),this.activeTabId===e&&this.tabs.length>0&&(this.activeTabId=this.tabs[0].id),this.update();}updateTab(e,n){let r=this.tabs.find(s=>s.id===e);r&&(Object.assign(r,n),this.update());}getActiveTab(){return this.tabs.find(e=>e.id===this.activeTabId)}render(){let e=[P.container,`__tabbedview__--${this.position}`,`__tabbedview__--${this.style}`,this.className].filter(Boolean).join(" ");return createElement("div",{className:e},this.renderTabList(),this.renderTabContent())}renderTabList(){let e=[P.header,this.headerClassName].filter(Boolean).join(" ");return createElement("div",{className:e},...this.tabs.map(n=>this.renderTab(n)))}renderTab(e){let n=this.activeTabId===e.id,r=[P.tab.base,n?P.tab.active:"",e.disabled?P.tab.disabled:""].filter(Boolean).join(" "),s=e.translateKey?h(e.translateKey):e.label;return createElement("button",{key:e.id,className:r,onclick:()=>this.setActiveTab(e.id),disabled:e.disabled,"data-translate":e.translateKey,"aria-selected":n,role:"tab"},e.icon?createElement("i",{className:e.icon}):null,createElement("span",{},s),e.badge!==void 0&&e.badge!==null&&e.badge!==0?createElement("span",{className:P.tab.badge},typeof e.badge=="number"&&e.badge>99?"99+":String(e.badge)):null)}renderTabContent(){let e=[P.content.container,this.contentClassName].filter(Boolean).join(" "),n=this.getActiveTab();return n?createElement("div",{className:e,role:"tabpanel"},this.renderActiveTabContent(n)):createElement("div",{className:e},createElement("div",{className:P.content.emptyState},createElement("p",{},"No tab selected")))}renderActiveTabContent(e){if(e.component)try{if(e.component instanceof v){this.currentTabComponent=e.component;let n=this.currentTabComponent.render(),r={...n.props,ref:i=>{i&&this.currentTabComponent&&(this.currentTabComponent._element=i),typeof n.props.ref=="function"&&n.props.ref(i);}},s={...n,props:r};return typeof this.currentTabComponent.onMount=="function"&&setTimeout(()=>{this.currentTabComponent&&typeof this.currentTabComponent.onMount=="function"&&this.currentTabComponent.onMount();},0),s}if(typeof e.component=="function"){let n=e.component;return n.prototype&&typeof n.prototype.render=="function"?(this.currentTabComponent||(this.currentTabComponent=new n,this.currentTabComponent&&typeof this.currentTabComponent.onMount=="function"&&setTimeout(()=>{this.currentTabComponent&&typeof this.currentTabComponent.onMount=="function"&&this.currentTabComponent.onMount();},0)),this.currentTabComponent.render()):n()}}catch(n){return console.error("Error rendering tab component:",n),createElement("div",{className:P.content.error},"Error rendering tab content")}return e.content?e.content:createElement("div",{className:P.content.emptyState},createElement("p",{},"No content available"))}};p([f],x.prototype,"activeTabId"),p([f],x.prototype,"tabs"),p([f],x.prototype,"position"),p([f],x.prototype,"style"),p([f],x.prototype,"className"),p([f],x.prototype,"headerClassName"),p([f],x.prototype,"contentClassName"),p([f],x.prototype,"showTabCount"),p([f],x.prototype,"persistState"),p([f],x.prototype,"storageKey");function Oe(o){let t=new x;return t.init(o),t}async function An(o,t){let e=Oe(t);return await e.mount(o),e}var g={container:"bb_itemsLoaderContainer",list:"bb_itemsLoaderList",searchbar:"bb_itemsLoaderSearchbar",loading:"bb_itemsLoaderLoading",error:"bb_itemsLoaderError",trigger:"bb_itemsLoaderTrigger",end:"bb_itemsLoaderEnd",emptyState:"bb_tabbedviewEmptyState",button:"bb_btn"},ae=class extends v{constructor(){super(...arguments);this.items=[];this.loadState={loading:false,error:null,hasMore:true,page:0,total:0};this.filters={};this.scrollContainer=null;this.loadMoreObserver=null;this.currentLoadMoreTrigger=null;this.isUpdating=false;this.observerReconnectAttempts=0;this.maxObserverAttempts=5;this.itemsListContainer=null;this.searchInput=null;this.searchDebounceTimer=null;this.handleScroll=()=>{if(!this.scrollContainer||this.loadState.loading||!this.loadState.hasMore)return;let{scrollTop:e,scrollHeight:n,clientHeight:r}=this.scrollContainer;n-e-r<this.config.scrollThreshold&&this.loadMore();};this.handleItemClick=(e,n)=>{this.config.onItemClick?.(e,n);};}initialize(e){this.config={pageSize:10,loadMoreText:"Load More",loadingText:"Loading...",errorText:"Failed to load items",containerClassName:g.container,itemClassName:"__itemsLoader-item",enableInfiniteScroll:true,scrollThreshold:200,enableSearch:false,searchPlaceholder:"Search...",searchFilterKey:"search",searchDebounceMs:300,extractItems:n=>n.notifications||n.items||n.data||[],extractTotal:n=>n.total||n.count||0,...e},this.config.filters&&(this.filters={...this.config.filters}),this.config.initialItems&&(this.items=[...this.config.initialItems]);}async onMount(){this.items.length===0&&await this.loadMore(),this.config.enableInfiniteScroll&&this.setupInfiniteScroll(),this.config.scrollThreshold&&this.setupScrollListener();}onUnmount(){this.disconnectObserver(),this.scrollContainer&&(this.scrollContainer.removeEventListener("scroll",this.handleScroll),this.scrollContainer=null);}async loadMore(){if(!(this.loadState.loading||!this.loadState.hasMore))try{this.loadState={...this.loadState,loading:!0,error:null},this.updateLoadingState();let e=this.loadState.page+1,n;if(typeof this.config.fetchUrl=="function")n=this.config.fetchUrl(e,this.filters);else {let d=this.config.fetchUrl.includes("?")?"&":"?",u=new URLSearchParams({page:e.toString(),limit:this.config.pageSize.toString(),...this.filters});n=`${this.config.fetchUrl}${d}${u}`;}let r={"Content-Type":"application/json"},s=this.config.getAuthToken?.();s&&(r.Authorization=`Bearer ${s}`);let i=await fetch(n,{credentials:"include",headers:r});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);let a=await i.json(),l=this.config.extractItems(a),c=this.config.extractTotal(a);this.items=[...this.items,...l],this.loadState={loading:!1,error:null,hasMore:this.items.length<c,page:e,total:c},this.appendNewItems(l),this.observerReconnectAttempts=0,this.reconnectObserver(),this.config.onLoadMore?.(e,this.items);}catch(e){this.loadState={...this.loadState,loading:false,error:e instanceof Error?e.message:this.config.errorText},this.updateLoadingState(),this.updateFooter(),this.config.onError?.(e instanceof Error?e:new Error("Unknown error"));}}async reload(){this.items=[],this.loadState={loading:false,error:null,hasMore:true,page:0,total:0},await this.loadMore();}async applyFilters(e){if(!this.isUpdating){this.isUpdating=true,this.filters={...e},this.items=[],this.loadState={loading:true,error:null,hasMore:true,page:0,total:0},this.updateLoadingState();try{let n=typeof this.config.fetchUrl=="function"?this.config.fetchUrl(1,this.filters):(()=>{let d=this.config.fetchUrl.includes("?")?"&":"?",u=new URLSearchParams({page:"1",limit:this.config.pageSize.toString(),...this.filters});return `${this.config.fetchUrl}${d}${u}`})(),r={"Content-Type":"application/json"},s=this.config.getAuthToken?.();s&&(r.Authorization=`Bearer ${s}`);let i=await fetch(n,{credentials:"include",headers:r});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);let a=await i.json(),l=this.config.extractItems(a),c=this.config.extractTotal(a);if(this.items=[...l],this.loadState={loading:!1,error:null,hasMore:this.items.length<c,page:1,total:c},this.itemsListContainer&&(this.itemsListContainer.innerHTML=""),this.element&&this.element.querySelectorAll(`${g.trigger}, ${g.end}, ${g.error}, ${g.loading}, ${g.emptyState}`).forEach(d=>d.remove()),this.items.length>0)this.itemsListContainer||(this.itemsListContainer=this.element?.querySelector(`.${g.list}`)),this.itemsListContainer&&this.appendNewItems(this.items);else if(this.config.emptyStateConfig&&this.element){let d=this.renderEmptyState(),u=createDOMElement(d);this.element.appendChild(u);}this.itemsListContainer=this.element?.querySelector(`.${g.list}`),this.observerReconnectAttempts=0,this.reconnectObserver(),this.config.onFiltersChange?.(this.filters);}catch(n){this.loadState={...this.loadState,loading:false,error:n instanceof Error?n.message:this.config.errorText},this.updateLoadingState(),this.config.onError?.(n instanceof Error?n:new Error("Unknown error"));}finally{this.isUpdating=false;}}}async handleSearch(e){this.searchDebounceTimer&&clearTimeout(this.searchDebounceTimer),this.searchDebounceTimer=setTimeout(async()=>{let n={...this.filters};e.trim()?n[this.config.searchFilterKey]=e.trim():delete n[this.config.searchFilterKey],await this.applyFilters(n);},this.config.searchDebounceMs);}updateItems(e){this.items=[...e],this.itemsListContainer&&(this.itemsListContainer.innerHTML="",this.appendNewItems(e));}appendNewItems(e){if(this.itemsListContainer||(this.itemsListContainer=this.element?.querySelector(`.${g.list}`)),!this.itemsListContainer)return;let n=this.items.length-e.length;e.forEach((r,s)=>{let i=this.config.renderItem(r,n+s);this.config.onItemClick?(i.className=`${i.className} ${this.config.itemClassName} clickable`,i.onclick=()=>this.handleItemClick(r,n+s)):i.className=`${i.className} ${this.config.itemClassName}`,this.itemsListContainer.appendChild(i);}),this.updateFooter();}updateLoadingState(){let e=this.element?.querySelector(`.${g.container}`);if(!e)return;let n=e.querySelector(`.${g.loading}`);this.loadState.loading?n||(n=this.renderLoading(),e.appendChild(n)):n&&n.remove();}updateFooter(){let e=this.element;if(e){if(e.querySelectorAll(`.${g.trigger}, .${g.end}, .${g.emptyState}`).forEach(n=>{n.remove();}),this.items.length===0&&!this.loadState.loading&&this.config.emptyStateConfig){let n=this.renderEmptyState(),r=createDOMElement(n);e.appendChild(r);return}if(this.loadState.hasMore&&!this.loadState.loading&&this.items.length>0){let n=this.renderLoadMoreTrigger(),r=createDOMElement(n);e.appendChild(r);}if(!this.loadState.hasMore&&this.items.length>0){let n=this.renderEndMessage(),r=createDOMElement(n);e.appendChild(r);}}}setupInfiniteScroll(){this.loadMoreObserver&&this.loadMoreObserver.disconnect(),this.loadMoreObserver=new IntersectionObserver(e=>{let[n]=e;n.isIntersecting&&!this.loadState.loading&&this.loadState.hasMore&&this.loadMore();},{threshold:.1,rootMargin:"50px"}),this.reconnectObserver();}reconnectObserver(){if(!this.config.enableInfiniteScroll||!this.loadMoreObserver)return;this.currentLoadMoreTrigger&&(this.loadMoreObserver.unobserve(this.currentLoadMoreTrigger),this.currentLoadMoreTrigger=null);let e=()=>{this.observerReconnectAttempts++;let n=this.element?.querySelector('[data-load-more-trigger="true"]');if(n)return this.loadMoreObserver.observe(n),this.currentLoadMoreTrigger=n,this.observerReconnectAttempts=0,true;if(this.observerReconnectAttempts<this.maxObserverAttempts){let r=[50,100,200,300,500][Math.min(this.observerReconnectAttempts-1,4)];setTimeout(e,r);}else this.observerReconnectAttempts=0;return  false};requestAnimationFrame(e);}disconnectObserver(){this.loadMoreObserver&&this.currentLoadMoreTrigger&&(this.loadMoreObserver.unobserve(this.currentLoadMoreTrigger),this.currentLoadMoreTrigger=null);}setupScrollListener(){requestAnimationFrame(()=>{this.scrollContainer=this.element?.querySelector("[data-notifications-loader]"),this.scrollContainer||(this.scrollContainer=this.element),this.scrollContainer&&this.scrollContainer.addEventListener("scroll",this.handleScroll);});}render(){return this.items.length===0&&!this.loadState.loading&&this.loadState.page>0&&this.config.emptyStateConfig?this.renderEmptyState():createElement("div",{className:this.config.containerClassName},this.config.enableSearch?this.renderSearchBar():null,createElement("div",{className:g.list,ref:e=>{e&&(this.itemsListContainer=e);}}),this.loadState.error?this.renderError():null,this.loadState.loading?this.renderLoading():null,this.loadState.hasMore&&!this.loadState.loading&&this.items.length>0?this.renderLoadMoreTrigger():null,!this.loadState.hasMore&&this.items.length>0?this.renderEndMessage():null)}renderSearchBar(){return createElement("div",{className:g.searchbar,style:"margin-bottom: 12px;"},createElement("div",{className:"row gap-sm",style:"position: relative;"},createElement("i",{className:"fas fa-search",style:"position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-color-quaternary);"}),createElement("input",{type:"text",className:"__input",placeholder:this.config.searchPlaceholder,style:"padding-left: 36px; flex: 1;",ref:e=>{e&&(this.searchInput=e,this.searchInput.addEventListener("input",n=>{let r=n.target.value;this.handleSearch(r);}));}})))}renderEmptyState(){let e=this.config.emptyStateConfig;return createElement("div",{className:g.emptyState},createElement("i",{className:`__icon ${e.icon}`}),createElement("h3",{className:"__title"},e.title),createElement("p",{className:"__desc"},e.description))}renderLoading(){return createElement("div",{className:g.loading},createElement("i",{className:"fas fa-spinner fa-spin"}),createElement("p",{},this.config.loadingText))}renderError(){return createElement("div",{className:g.error},createElement("i",{className:"fas fa-exclamation-triangle"}),createElement("p",{},this.loadState.error),createElement("button",{className:`${g.button} secondary`,onclick:()=>this.loadMore()},createElement("i",{className:"fas fa-redo"})," Retry"))}renderLoadMoreTrigger(){return createElement("div",{className:g.trigger,"data-load-more-trigger":"true",style:"height: 1px; visibility: hidden;"})}renderEndMessage(){return createElement("div",{className:g.end},createElement("i",{className:"fas fa-check-circle"}),h("global.all_loaded",{count:String(this.loadState.total),title:"global.sm.notifications"}))}};function qn(o){let t=new ae;return t.initialize(o),t}function De(o,t){let e=null;return (...n)=>{e!==null&&clearTimeout(e),e=setTimeout(()=>{e=null,o(...n);},t);}}function Ve(o,t){let e=0,n=null;return (...r)=>{let s=Date.now(),i=s-e;i>=t?(e=s,o(...r)):n||(n=setTimeout(()=>{e=Date.now(),n=null,o(...r);},t-i));}}function Ae(...o){let t=[];for(let e of o)if(e){if(typeof e=="string")t.push(e);else if(typeof e=="object")for(let[n,r]of Object.entries(e))r&&t.push(n);}return t.join(" ")}function He(o,t="YYYY-MM-DD"){let e=o instanceof Date?o:new Date(o);if(isNaN(e.getTime()))throw new Error("Invalid date provided to formatDate");let n=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0"),l=String(e.getSeconds()).padStart(2,"0");return t.replace("YYYY",String(n)).replace("MM",r).replace("DD",s).replace("HH",i).replace("mm",a).replace("ss",l)}function A(o){if(o===null||typeof o!="object")return o;if(o instanceof Date)return new Date(o.getTime());if(Array.isArray(o))return o.map(t=>A(t));if(o instanceof RegExp)return new RegExp(o.source,o.flags);if(o instanceof Map){let t=new Map;return o.forEach((e,n)=>{t.set(A(n),A(e));}),t}if(o instanceof Set){let t=new Set;return o.forEach(e=>{t.add(A(e));}),t}if(Object.prototype.toString.call(o)==="[object Object]"){let t={};for(let e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=A(o[e]));return t}return o}function ce(o,...t){if(!t.length)return o;let e=t.shift();if(!e)return o;if(Z(o)&&Z(e)){for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let r=e[n],s=o[n];r!==void 0&&(Z(r)&&!Array.isArray(r)?((!s||!Z(s))&&(o[n]={}),ce(o[n],r)):o[n]=r);}}return ce(o,...t)}function Z(o){return o!==null&&typeof o=="object"&&!Array.isArray(o)}var le=0;function Be(o="id"){let t=Date.now().toString(36),e=Math.random().toString(36).substring(2,11);le=(le||0)+1;let n=le.toString(36);return `${o}_${t}_${e}_${n}`}function Ue(o){if(o<0)throw new Error("Sleep duration must be non-negative");return new Promise(t=>setTimeout(t,o))}function ze(o){return o==null?true:typeof o=="string"?o.trim().length===0:Array.isArray(o)?o.length===0:o instanceof Map||o instanceof Set?o.size===0:typeof o=="object"?Object.keys(o).length===0:false}function je(o){return o?o.charAt(0).toUpperCase()+o.slice(1):""}function qe(o){return o?o.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase():""}function ye(o){return o?o.replace(/[-_\s]+(.)?/g,(t,e)=>e?e.toUpperCase():"").replace(/^[A-Z]/,t=>t.toLowerCase()):""}function We(o){if(!o)return "";let t=ye(o);return t.charAt(0).toUpperCase()+t.slice(1)}function Ge(o,t,e="..."){return !o||o.length<=t?o:o.substring(0,t-e.length)+e}function Je(o){let t={},e=o.replace(/^\?/,"");if(!e)return t;let n=e.split("&");for(let r of n){let[s,i]=r.split("=").map(decodeURIComponent);if(!s)continue;let a=i||"";if(s.endsWith("[]")){let l=s.slice(0,-2);t[l]||(t[l]=[]),t[l].push(a);}else t[s]=a;}return t}function Ye(o){let t=[];for(let[e,n]of Object.entries(o))if(n!=null)if(Array.isArray(n))for(let r of n)r!=null&&t.push(`${encodeURIComponent(e)}[]=${encodeURIComponent(String(r))}`);else t.push(`${encodeURIComponent(e)}=${encodeURIComponent(String(n))}`);return t.length>0?`?${t.join("&")}`:""}function Qe(o,t,e){return Math.min(Math.max(o,t),e)}function Ze(){return typeof window<"u"&&typeof document<"u"}function Xe(o,t){try{return JSON.parse(o)}catch{return t}}var Gn={debounce:De,throttle:Ve,classNames:Ae,formatDate:He,deepClone:A,deepMerge:ce,uniqueId:Be,sleep:Ue,isEmpty:ze,capitalize:je,kebabCase:qe,camelCase:ye,pascalCase:We,truncate:Ge,parseQuery:Je,stringifyQuery:Ye,clamp:Qe,isBrowser:Ze,safeJsonParse:Xe};var we=class{constructor(t){this.observer=null;this.observedElements=new Map;this.observer=new IntersectionObserver(e=>{e.forEach(n=>{let r=this.observedElements.get(n.target)??false,s=n.isIntersecting;s&&!r?(this.observedElements.set(n.target,true),t.onEnter?.(n),t.once&&this.unobserve(n.target)):!s&&r&&(this.observedElements.set(n.target,false),t.onExit?.(n));});},{root:t.root||null,rootMargin:t.rootMargin||"0px",threshold:t.threshold??.1});}observe(t){this.observer&&(this.observer.observe(t),this.observedElements.set(t,false));}unobserve(t){this.observer&&(this.observer.unobserve(t),this.observedElements.delete(t));}disconnect(){this.observer&&(this.observer.disconnect(),this.observedElements.clear());}};function Yn(o,t){let e=new IntersectionObserver(n=>{n.forEach(r=>{r.isIntersecting&&(t(r),e.unobserve(o));});},{threshold:.1});return e.observe(o),()=>e.disconnect()}var ue=class o{constructor(){this.dropdowns=new Map;this.openDropdowns=new Set;this.setupGlobalClickHandler();}static getInstance(){return o.instance||(o.instance=new o),o.instance}register(t,e,n,r){this.dropdowns.set(t,{id:t,element:e,parentId:r,onOpen:n?.onOpen,onClose:n?.onClose});}unregister(t){this.openDropdowns.has(t)&&this.closeDropdown(t),this.dropdowns.delete(t);}openDropdown(t){let e=this.dropdowns.get(t);if(!e){console.warn("DropdownManager: Dropdown not registered:",t);return}if(this.openDropdowns.has(t))return;let n=this.getParentChain(t),r=[];for(let s of this.openDropdowns)this.dropdowns.get(s)&&(n.includes(s)||this.getParentChain(s).includes(t)||r.push(s));for(let s of r)this.closeDropdown(s);this.openDropdowns.add(t),e.onOpen&&e.onOpen();}getParentChain(t){let e=[t],n=t;for(;n;){let r=this.dropdowns.get(n);if(r?.parentId)e.push(r.parentId),n=r.parentId;else break}return e}closeDropdown(t){if(!this.openDropdowns.has(t))return;let e=[];for(let r of this.openDropdowns)this.dropdowns.get(r)?.parentId===t&&e.push(r);for(let r of e)this.closeDropdown(r);this.openDropdowns.delete(t);let n=this.dropdowns.get(t);n?.onClose&&n.onClose();}closeAllDropdowns(){if(this.openDropdowns.size===0)return;let t=Array.from(this.openDropdowns);for(let e of t){let n=this.dropdowns.get(e);n?.parentId&&this.openDropdowns.has(n.parentId)||this.closeDropdown(e);}}isOpen(t){return this.openDropdowns.has(t)}isAnyOpen(){return this.openDropdowns.size>0}setupGlobalClickHandler(){this.clickHandler=t=>{let e=t.target;for(let[,n]of this.dropdowns)if(n.element.contains(e))return;this.closeAllDropdowns();},document.addEventListener("click",this.clickHandler,false);}destroy(){this.clickHandler&&(document.removeEventListener("click",this.clickHandler,false),this.clickHandler=void 0),this.dropdowns.clear(),this.openDropdowns.clear();}};function Zn(){return ue.getInstance()}function de(o){let t=typeof o=="string"?new Date(o):o,n=new Date().getTime()-t.getTime(),r=Math.floor(n/1e3),s=Math.floor(r/60),i=Math.floor(s/60),a=Math.floor(i/24),l=Math.floor(a/7),c=Math.floor(a/30),d=Math.floor(a/365),u="";return r<0?u=h("time.just_now"):r<60?u=h("time.just_now"):s<2?u=h("time.minute_ago"):s<60?u=h("time.minutes_ago",{count:s.toString()}):i<2?u=h("time.hour_ago"):i<24?u=h("time.hours_ago",{count:i.toString()}):a<2?u=h("time.day_ago"):a<7?u=h("time.days_ago",{count:a.toString()}):l<2?u=h("time.week_ago"):l<4?u=h("time.weeks_ago",{count:l.toString()}):c<2?u=h("time.month_ago"):c<12?u=h("time.months_ago",{count:c.toString()}):d<2?u=h("time.year_ago"):u=h("time.years_ago",{count:d.toString()}),{formatted:u,originalDate:t.toISOString(),title:t.toLocaleString()}}function tr(o){let{formatted:t,title:e}=de(o);return {text:t,title:e}}function nr(o){return de(o).formatted}function rr(o){return de(o).title}setConfig({devMode:false,sanitizeHTML:true});export{ee as CombinedContext,v as Component,j as Context,ue as DropdownManager,W as I18nManager,ae as ItemsLoader,M as Loader,Y as Popup,fe as Provider,oe as Router,ve as SmartForm,K as SmartFormComponent,ie as Store,H as StyleManager,x as TabbedView,J as Toast,we as VisibilityObserver,ye as camelCase,je as capitalize,Qe as clamp,Ae as classNames,Ee as clearHookContext,nn as client,ct as computed,At as connect,mt as createCombinedContext,Vt as createComputedStore,ft as createContext,kt as createFunctionalComponent,qn as createItemsLoader,Me as createStore,Oe as createTabbedView,Yt as createTranslator,pe as css,De as debounce,A as deepClone,ce as deepMerge,He as formatDate,de as formatRelativeTime,nr as formatTimeAgo,zt as getCurrentLanguage,se as getCurrentPath,Zn as getDropdownManager,E as getI18n,k as getPopup,Ot as getQueryParam,Pe as getQueryParams,Wt as getSupportedLanguages,tr as getTimeDisplay,rr as getTimeTitle,U as getToast,Jt as getTranslations,Nt as goBack,Rt as goForward,Gt as hasKey,Ne as initI18n,Fe as initPopup,$e as initToast,be as initializeI18n,Ze as isBrowser,It as isCurrentPath,$t as isCurrentPathPrefix,ze as isEmpty,qe as kebabCase,Qt as loadFromUrl,jt as loadLanguage,qt as loadTranslations,An as mountTabbedView,me as navigate,Ft as navigateWithQuery,Yn as observeVisibility,Je as parseQuery,We as pascalCase,Rn as popup,Kt as reloadRoute,I as router,Xe as safeJsonParse,z as scheduler,xe as setHookContext,Ut as setLanguage,Ue as sleep,f as state,Ye as stringifyQuery,h as t,Bt as tLang,Ve as throttle,cn as toast,Ge as truncate,Be as uniqueId,ne as useCallback,gt as useContext,Tt as useDebounce,R as useEffect,Lt as useEventListener,xt as useFetch,St as useInterval,wt as useLocalStorage,Le as useMemo,Ct as usePrevious,yt as useReducer,re as useRef,N as useState,_t as useToggle,Et as useWindowSize,Gn as utils,ut as watch};//# sourceMappingURL=main.js.map
//# sourceMappingURL=main.js.map